<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
  <title>–ü—Ä–æ—Ñ–∏–ª—å ‚Äî Rewatch</title>
</head>
<body>
<header>
  <!-- –õ–û–ì–û–¢–ò–ü / –°–°–´–õ–ö–ê –ù–ê –ì–õ–ê–í–ù–£–Æ -->
  <a href="{{ url_for('index') }}" class="header-logo">Rewatch</a>

  <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
    <nav>
        <a href="{{ url_for('catalog') }}"  class="{{ 'active' if request.endpoint=='catalog' else '' }}">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a href="{{ url_for('my_list') }}"  class="{{ 'active' if request.endpoint=='my_list' else '' }}">–ú–æ–π —Å–ø–∏—Å–æ–∫</a>
        <a href="{{ url_for('stats') }}"    class="{{ 'active' if request.endpoint=='stats' else '' }}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
        <a href="{{ url_for('collections') }}" class="{{ 'active' if request.endpoint in ['collections','collection_view'] else '' }}">–ö–æ–ª–ª–µ–∫—Ü–∏–∏</a>
        <a href="{{ url_for('profile') }}"  class="{{ 'active' if request.endpoint in ['profile','edit_profile'] else '' }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
    </nav>
</header>

<main class="profile-page">
  <section class="profile-header">
    <div class="avatar">
      <img src="{{ user.avatar_url or 'https://i.pravatar.cc/150' }}" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" />
    </div>
    <div class="profile-info">
      <h1 class="profile__name">{{ user.username }}</h1>
      <p>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: {{ user.created_at.strftime('%Y.%m.%d') }}</p>
      <p>üì∫ –í—Å–µ–≥–æ —Ç–∞–π—Ç–ª–æ–≤: <strong>{{ total_titles or 0 }}</strong></p>
      <a class="btn-primary profile__edit-btn" href="{{ url_for('edit_profile') }}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
    </div>
  </section>

  <section class="profile-stats">
    <h3>–ú–æ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
    <div class="stats-grid">
      <div class="stat-card">
        <h4>–§–∏–ª—å–º—ã</h4>
        <p><strong>{{ movies_completed or 0 }}</strong> –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</p>
      </div>
      <div class="stat-card">
        <h4>–°–µ—Ä–∏–∞–ª—ã</h4>
        <p><strong>{{ tv_completed or 0 }}</strong> –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</p>
      </div>
    </div>
  </section>

  <section class="recent-activity">
    <h3>–ù–µ–¥–∞–≤–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã</h3>

    {% if recent_items %}
      <div class="activity-list">
        {% for it in recent_items %}
          <div class="activity-item">
            {% if it.poster %}
              <img src="{{ it.poster }}" alt="{{ it.title }}">
            {% endif %}
            <div>
              <h4><a href="{{ it.href }}" style="color:inherit; text-decoration:none;">{{ it.title }}</a></h4>
              <p>
                {% if it.rating_user %}‚≠ê {{ it.rating_user }} / 10{% else %}–ë–µ–∑ –æ—Ü–µ–Ω–∫–∏{% endif %}
                {% if it.year %} | {{ it.year }}{% endif %}
              </p>
              {% if it.note %}
                <p style="margin-top:.35rem; color:#a9a9a9;">–ó–∞–º–µ—Ç–∫–∞: {{ it.note }}</p>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="activity-list">
        <div class="activity-item">
          <div>
            <h4>–ü–æ–∫–∞ –ø—É—Å—Ç–æ</h4>
            <p style="color:#a9a9a9;">–ü–æ—Å—Ç–∞–≤—å—Ç–µ —Å—Ç–∞—Ç—É—Å ¬´–ó–∞–≤–µ—Ä—à–µ–Ω–æ¬ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–∞–π—Ç–ª–∞ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å.</p>
          </div>
        </div>
      </div>
    {% endif %}
  </section>

  <section class="profile-actions">
    <a class="btn-primary" href="{{ url_for('catalog') }}">–î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π—Ç–ª</a>
    <a class="btn-outline" href="{{ url_for('my_list') }}">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫</a>
  </section>
</main>

<footer>
  <p>¬© 2025 Rewatch</p>
</footer>
</body>
</html>
